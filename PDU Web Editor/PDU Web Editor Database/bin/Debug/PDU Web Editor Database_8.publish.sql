/*
Deployment script for PDU Web Editor Database

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "PDU Web Editor Database"
:setvar DefaultFilePrefix "PDU Web Editor Database"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL10_50.DEV\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL10_50.DEV\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
/*
The table [dbo].[tbl_PDURecords] is being dropped and re-created since all non-computed columns within the table have been redefined.
*/

IF EXISTS (select top 1 1 from [dbo].[tbl_PduRecords])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [dbo].[tbl_PDUs].[Pdu_PDURecordId] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[tbl_PDUs])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
PRINT N'The following operation was generated from a refactoring log file fd03957c-3bb1-47e3-8174-8e7ba81b35c7, 7d02cc58-6ab2-4818-86f8-8abe738a40a8, 2760c7cc-7ccb-4938-91e6-90085397e4e9';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_PDURecordId] to Rec_PDURecordId';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_PDURecordId]', @newname = N'Rec_PDURecordId', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 4e683407-405b-4ef0-9121-a682f7f1ac16, 88c3c5ed-959a-4d11-8be6-1a8c8daf816c, c6704492-7cc2-4fb3-a1d9-b1ece012f344';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_PDURecordName] to Rec_PDURecordName';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_PDURecordName]', @newname = N'Rec_PDURecordName', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 2c72fd85-fc06-4dbe-9f3c-0c4b0f267bfa, 5d224fe9-e5cd-46c5-99b3-5a581230807d, 4eadc249-52e3-43ca-b2c1-44168be8c065';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_PDURecordStartDate] to Rec_PDURecordStartDate';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_PDURecordStartDate]', @newname = N'Rec_PDURecordStartDate', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file dfd64c44-0a74-4ed6-8d86-233e2c58835f, e9d75f37-077e-42a0-9c56-61f25ccf01db';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_PDURecordEndDate] to Rec_RecordEndDate';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_PDURecordEndDate]', @newname = N'Rec_RecordEndDate', @objtype = N'COLUMN';


GO
PRINT N'Dropping ck_PDURecordWeight...';


GO
ALTER TABLE [dbo].[tbl_PDURecords] DROP CONSTRAINT [ck_PDURecordWeight];


GO
PRINT N'The following operation was generated from a refactoring log file d5a8ee14-6de3-4541-9f36-4b4487355bad';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_PDURecordWeight] to Rec_PDURecordWeight';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_PDURecordWeight]', @newname = N'Rec_PDURecordWeight', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file b3aa203d-d1a6-4e5a-a1be-c5f1d2191ea3';

PRINT N'Rename [dbo].[tbl_PDURecords].[Pdr_AssetUniqueId] to Rec_AssetUniqueId';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDURecords].[Pdr_AssetUniqueId]', @newname = N'Rec_AssetUniqueId', @objtype = N'COLUMN';


GO
PRINT N'Rename refactoring operation with key 7cc18a33-d2ea-469f-9656-ea4d1a8691e0, 95c45857-5e03-4c59-9fff-4f5b2a447575 is skipped, element [dbo].[tbl_PduRecords].[Id] (SqlSimpleColumn) will not be renamed to Pdr__PDUUniqueId';


GO
PRINT N'Rename refactoring operation with key ceb7672c-1475-4fd5-a305-1809c52bd4e8 is skipped, element [dbo].[tbl_PduRecords].[Prd_] (SqlSimpleColumn) will not be renamed to Prd_PDURecordId';


GO
PRINT N'Rename refactoring operation with key 0770f994-eb44-40b6-84fc-2a15c2e8dd49 is skipped, element [dbo].[tbl_Records].[Rec_PDURecordId] (SqlSimpleColumn) will not be renamed to Rec_RecordId';


GO
PRINT N'Rename refactoring operation with key 5f8fda53-c3ad-4a98-bb6d-9199093e782b is skipped, element [dbo].[tbl_Records].[Rec_PDURecordName] (SqlSimpleColumn) will not be renamed to Rec_RecordName';


GO
PRINT N'Rename refactoring operation with key b28a28a9-fe7b-4d55-a271-0ea4a676e74f is skipped, element [dbo].[tbl_Records].[Rec_PDURecordStartDate] (SqlSimpleColumn) will not be renamed to Rec_RecordStartDate';


GO
PRINT N'Rename refactoring operation with key a4bfb31a-82e1-4894-8cfc-d7dab7643b73 is skipped, element [dbo].[tbl_Records].[Rec_PDURecordWeight] (SqlSimpleColumn) will not be renamed to Rec_RecordWeight';


GO
PRINT N'The following operation was generated from a refactoring log file 26f186d2-b824-47a3-ac52-1b194a9a2966';

PRINT N'Rename [dbo].[tbl_Assets].[Ast_AssetFileName] to Ast_FileName';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_Assets].[Ast_AssetFileName]', @newname = N'Ast_FileName', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file c11dd960-0933-499b-9f9d-8fdd2676278b';

PRINT N'Rename [dbo].[tbl_PDUs].[Pdu_PDUFileName] to Pdu_FileName';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDUs].[Pdu_PDUFileName]', @newname = N'Pdu_FileName', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 779ded8f-d77d-42e2-9a64-248fce2d08e9';

PRINT N'Rename [dbo].[tbl_PDUs].[Pdu_PDUUpdateByWho] to Pdu_UpdateByWho';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDUs].[Pdu_PDUUpdateByWho]', @newname = N'Pdu_UpdateByWho', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 7e84a9ea-2858-401d-afdb-22dbe1cd5172';

PRINT N'Rename [dbo].[tbl_PDUs].[Pdu_PDUUpdateOnDate] to Pdu_UpdateOnDate';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDUs].[Pdu_PDUUpdateOnDate]', @newname = N'Pdu_UpdateOnDate', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 072dfdf4-45d4-48f8-aecf-90591c02f950';

PRINT N'Rename [dbo].[tbl_PDUs].[Pdu_PDUType] to Pdu_Type';


GO
EXECUTE sp_rename @objname = N'[dbo].[tbl_PDUs].[Pdu_PDUType]', @newname = N'Pdu_Type', @objtype = N'COLUMN';


GO
PRINT N'Dropping fk_AssetUinqueId...';


GO
ALTER TABLE [dbo].[tbl_PDURecords] DROP CONSTRAINT [fk_AssetUinqueId];


GO
PRINT N'Dropping fk_Pdu_PDURecordId...';


GO
ALTER TABLE [dbo].[tbl_PDUs] DROP CONSTRAINT [fk_Pdu_PDURecordId];


GO
PRINT N'Dropping [dbo].[tbl_PDURecords]...';


GO
DROP TABLE [dbo].[tbl_PDURecords];


GO
PRINT N'Creating [dbo].[tbl_PduRecords]...';


GO
CREATE TABLE [dbo].[tbl_PduRecords] (
    [Pdr_PDUUniqueId] INT NOT NULL,
    [Pdr_RecordId]    INT NOT NULL,
    CONSTRAINT [pk_PduRecordId] PRIMARY KEY CLUSTERED ([Pdr_PDUUniqueId] ASC, [Pdr_RecordId] ASC)
);


GO
PRINT N'Altering [dbo].[tbl_PDUs]...';


GO
ALTER TABLE [dbo].[tbl_PDUs] DROP COLUMN [Pdu_PDURecordId];


GO
PRINT N'Starting rebuilding table [dbo].[tbl_Assets]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_tbl_Assets] (
    [Ast_AssetUniqueId] INT            IDENTITY (1, 1) NOT NULL,
    [Ast_FileName]      NVARCHAR (255) NOT NULL,
    [Ast_UpdatedByWho]  NVARCHAR (50)  NOT NULL,
    [Ast_UpdatedOnDate] DATE           NOT NULL,
    [Ast_FileLocation]  NVARCHAR (255) NOT NULL,
    CONSTRAINT [tmp_ms_xx_constraint_pk_Ast_AssetUniqueId] PRIMARY KEY CLUSTERED ([Ast_AssetUniqueId] ASC)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[tbl_Assets])
    BEGIN
        SET IDENTITY_INSERT [dbo].[tmp_ms_xx_tbl_Assets] ON;
        INSERT INTO [dbo].[tmp_ms_xx_tbl_Assets] ([Ast_AssetUniqueId], [Ast_FileName], [Ast_UpdatedByWho], [Ast_UpdatedOnDate], [Ast_FileLocation])
        SELECT   [Ast_AssetUniqueId],
                 [Ast_FileName],
                 [Ast_UpdatedByWho],
                 [Ast_UpdatedOnDate],
                 [Ast_FileLocation]
        FROM     [dbo].[tbl_Assets]
        ORDER BY [Ast_AssetUniqueId] ASC;
        SET IDENTITY_INSERT [dbo].[tmp_ms_xx_tbl_Assets] OFF;
    END

DROP TABLE [dbo].[tbl_Assets];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_tbl_Assets]', N'tbl_Assets';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_pk_Ast_AssetUniqueId]', N'pk_Ast_AssetUniqueId', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Creating [dbo].[tbl_Records]...';


GO
CREATE TABLE [dbo].[tbl_Records] (
    [Rec_RecordId]        INT            IDENTITY (1, 1) NOT NULL,
    [Rec_RecordName]      NVARCHAR (255) NOT NULL,
    [Rec_RecordStartDate] DATE           NOT NULL,
    [Rec_RecordEndDate]   DATE           NOT NULL,
    [Rec_RecordWeight]    INT            NOT NULL,
    [Rec_AssetUniqueId]   INT            NULL,
    CONSTRAINT [pk_Rec_PDURecordId] PRIMARY KEY CLUSTERED ([Rec_RecordId] ASC)
);


GO
PRINT N'Creating fk_Pdr_PDUUniqueId...';


GO
ALTER TABLE [dbo].[tbl_PduRecords] WITH NOCHECK
    ADD CONSTRAINT [fk_Pdr_PDUUniqueId] FOREIGN KEY ([Pdr_PDUUniqueId]) REFERENCES [dbo].[tbl_PDUs] ([Pdu_PDUUniqueId]);


GO
PRINT N'Creating fk_Pdr_RecordId...';


GO
ALTER TABLE [dbo].[tbl_PduRecords] WITH NOCHECK
    ADD CONSTRAINT [fk_Pdr_RecordId] FOREIGN KEY ([Pdr_RecordId]) REFERENCES [dbo].[tbl_Records] ([Rec_RecordId]);


GO
PRINT N'Creating fk_Rec_AssetUniqueId...';


GO
ALTER TABLE [dbo].[tbl_Records] WITH NOCHECK
    ADD CONSTRAINT [fk_Rec_AssetUniqueId] FOREIGN KEY ([Rec_AssetUniqueId]) REFERENCES [dbo].[tbl_Assets] ([Ast_AssetUniqueId]) ON DELETE SET NULL ON UPDATE CASCADE;


GO
PRINT N'Creating ck_Rec_PDURecordWeight...';


GO
ALTER TABLE [dbo].[tbl_Records] WITH NOCHECK
    ADD CONSTRAINT [ck_Rec_PDURecordWeight] CHECK ([Rec_RecordWeight] BETWEEN 1 AND 5);


GO
-- Refactoring step to update target server with deployed transaction logs
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'fd03957c-3bb1-47e3-8174-8e7ba81b35c7')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('fd03957c-3bb1-47e3-8174-8e7ba81b35c7')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '4e683407-405b-4ef0-9121-a682f7f1ac16')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('4e683407-405b-4ef0-9121-a682f7f1ac16')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2c72fd85-fc06-4dbe-9f3c-0c4b0f267bfa')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2c72fd85-fc06-4dbe-9f3c-0c4b0f267bfa')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'dfd64c44-0a74-4ed6-8d86-233e2c58835f')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('dfd64c44-0a74-4ed6-8d86-233e2c58835f')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'd5a8ee14-6de3-4541-9f36-4b4487355bad')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('d5a8ee14-6de3-4541-9f36-4b4487355bad')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'b3aa203d-d1a6-4e5a-a1be-c5f1d2191ea3')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('b3aa203d-d1a6-4e5a-a1be-c5f1d2191ea3')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7d02cc58-6ab2-4818-86f8-8abe738a40a8')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7d02cc58-6ab2-4818-86f8-8abe738a40a8')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '88c3c5ed-959a-4d11-8be6-1a8c8daf816c')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('88c3c5ed-959a-4d11-8be6-1a8c8daf816c')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5d224fe9-e5cd-46c5-99b3-5a581230807d')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5d224fe9-e5cd-46c5-99b3-5a581230807d')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'e9d75f37-077e-42a0-9c56-61f25ccf01db')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('e9d75f37-077e-42a0-9c56-61f25ccf01db')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2760c7cc-7ccb-4938-91e6-90085397e4e9')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2760c7cc-7ccb-4938-91e6-90085397e4e9')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'c6704492-7cc2-4fb3-a1d9-b1ece012f344')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('c6704492-7cc2-4fb3-a1d9-b1ece012f344')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '4eadc249-52e3-43ca-b2c1-44168be8c065')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('4eadc249-52e3-43ca-b2c1-44168be8c065')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7cc18a33-d2ea-469f-9656-ea4d1a8691e0')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7cc18a33-d2ea-469f-9656-ea4d1a8691e0')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '95c45857-5e03-4c59-9fff-4f5b2a447575')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('95c45857-5e03-4c59-9fff-4f5b2a447575')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'ceb7672c-1475-4fd5-a305-1809c52bd4e8')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('ceb7672c-1475-4fd5-a305-1809c52bd4e8')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '0770f994-eb44-40b6-84fc-2a15c2e8dd49')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('0770f994-eb44-40b6-84fc-2a15c2e8dd49')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5f8fda53-c3ad-4a98-bb6d-9199093e782b')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5f8fda53-c3ad-4a98-bb6d-9199093e782b')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'b28a28a9-fe7b-4d55-a271-0ea4a676e74f')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('b28a28a9-fe7b-4d55-a271-0ea4a676e74f')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'a4bfb31a-82e1-4894-8cfc-d7dab7643b73')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('a4bfb31a-82e1-4894-8cfc-d7dab7643b73')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'a53efcfc-a31a-49eb-9564-c74975d49bd4')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('a53efcfc-a31a-49eb-9564-c74975d49bd4')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '658172ab-770e-4b3a-9fdc-62ae66145c14')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('658172ab-770e-4b3a-9fdc-62ae66145c14')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '26f186d2-b824-47a3-ac52-1b194a9a2966')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('26f186d2-b824-47a3-ac52-1b194a9a2966')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'af621c2f-3868-461c-8e00-0121ec84acfa')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('af621c2f-3868-461c-8e00-0121ec84acfa')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '6312725b-7bc9-40a9-8d97-4258e7777cef')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('6312725b-7bc9-40a9-8d97-4258e7777cef')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'c11dd960-0933-499b-9f9d-8fdd2676278b')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('c11dd960-0933-499b-9f9d-8fdd2676278b')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '779ded8f-d77d-42e2-9a64-248fce2d08e9')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('779ded8f-d77d-42e2-9a64-248fce2d08e9')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7e84a9ea-2858-401d-afdb-22dbe1cd5172')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7e84a9ea-2858-401d-afdb-22dbe1cd5172')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '072dfdf4-45d4-48f8-aecf-90591c02f950')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('072dfdf4-45d4-48f8-aecf-90591c02f950')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '1d75fae7-6614-4156-a618-69bbc42cccdc')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('1d75fae7-6614-4156-a618-69bbc42cccdc')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'c056e162-5454-4eab-be52-884b620884bb')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('c056e162-5454-4eab-be52-884b620884bb')

GO

GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[tbl_PduRecords] WITH CHECK CHECK CONSTRAINT [fk_Pdr_PDUUniqueId];

ALTER TABLE [dbo].[tbl_PduRecords] WITH CHECK CHECK CONSTRAINT [fk_Pdr_RecordId];

ALTER TABLE [dbo].[tbl_Records] WITH CHECK CHECK CONSTRAINT [fk_Rec_AssetUniqueId];

ALTER TABLE [dbo].[tbl_Records] WITH CHECK CHECK CONSTRAINT [ck_Rec_PDURecordWeight];


GO
PRINT N'Update complete.';


GO
